üß™ Cen√°rios de Teste: DEV ‚Üí HML

1. Cen√°rios B√°sicos de Estrutura
Cen√°rio 1.1: Nova Tabela Criada em DEV
Situa√ß√£o: Desenvolvedor criou nova collection "clientes" em DEV
Objetivo: Migrar apenas estrutura (schema only) para HML
Teste:
- Criar tabela "anotacoes" em DEV com campos
- Executar migra√ß√£o com regra "Schema Only"
- Verificar se estrutura foi criada em HML sem dados

Status: OK

Cen√°rio 1.2: Novos Campos em Tabela Existente
Situa√ß√£o: Adicionados campos "cpf" e "data_nascimento" na tabela "users"
Objetivo: Atualizar estrutura em HML
Teste:
- Adicionar campos em DEV na tabela Anotacao
- Executar migra√ß√£o "Schema Only"
- Verificar se campos existem em HML
- Verificar se dados antigos n√£o foram afetados

Status: OK

2. Cen√°rios de Dados Novos
Cen√°rio 2.1: Dados de Configura√ß√£o Inicial
Situa√ß√£o: Cadastrados tipos de documentos, categorias, status padr√µes
Objetivo: Popular HML com dados mestres
Teste:
- Dados como pe√ßas 

Status: OK

Cen√°rio 2.2: Dados de Teste para QA
Situa√ß√£o: Time QA precisa de massa de dados para testes
Objetivo: Copiar dados de teste de DEV para HML
Teste:
- Criar ORderm de triagem fict√≠cios em DEV
- Executar migra√ß√£o com regra "Overwrite"
- Verificar quantidade e integridade dos dados

Status: OK

3. Cen√°rios de Atualiza√ß√£o de Dados
Cen√°rio 3.1: Atualiza√ß√£o de Pre√ßos de Produtos
Situa√ß√£o: Pre√ßos de produtos atualizados em DEV
Objetivo: Sincronizar pre√ßos em HML sem perder outros dados
Teste:
- Atualizei campo status Laudo

Status: OK

Cen√°rio 3.2: Corre√ß√£o de Dados Inconsistentes
Situa√ß√£o: Corre√ß√£o de emails duplicados em DEV
Objetivo: Aplicar corre√ß√µes em HML
Teste:
- 

Status: N√£o executado

4. Cen√°rios de Merge de Dados
Cen√°rio 4.1: Preservar Dados Criados em HML
Situa√ß√£o: HML tem dados de testes do QA que n√£o devem ser perdidos
Objetivo: Adicionar dados de DEV sem sobrescrever HML
Teste:
- HML criados clientes e ordem de triagem
- Executar migra√ß√£o com regra "Insert Ignore"
- Verificar se HML se n√£o foram apagados.

Status: OK

Cen√°rio 4.2: Sincroniza√ß√£o Parcial
Situa√ß√£o: Migrar apenas novas collections, preservar existentes
Objetivo: Adicionar dados sem afetar tabelas j√° em uso
Teste:
- HML criados clientes e ordem de triagem
- Executar migra√ß√£o com regra "Insert Ignore"
- Verificar se HML se n√£o foram apagados.

Status: OK

5. Cen√°rios de Relacionamentos
Cen√°rio 5.1: Tabelas com Foreign Keys
Situa√ß√£o: Migrar "anotacoes" que referenciam "usuario"
Objetivo: Manter integridade referencial
Teste:
- Adicionar campo usuario em anotacoes
- Depois migrar "anotacoes" com regra "Schema"
- Verificar se todas as FKs est√£o v√°lidas
- Verificar se n√£o h√° registros √≥rf√£os

Status: OK

Cen√°rio 5.2: Dados com Relacionamentos Many-to-Many
Situa√ß√£o: Tabela "users_roles" conecta users e roles
Objetivo: Migrar relacionamentos corretamente
Teste:
- Migrar "users", "roles" e "users_roles" em sequ√™ncia
- Verificar se todos os relacionamentos foram preservados
- Testar login com usu√°rios migrados

Status: N√£o executado

6. Cen√°rios de Volume de Dados
Cen√°rio 6.1: Migra√ß√£o de Tabela Grande
Situa√ß√£o: Tabela "equipamento" tem 2.000 registros
Objetivo: Testar performance e processamento em lotes
Teste:
- Executar migra√ß√£o de tabela com 50k+ registros
- Monitorar tempo de execu√ß√£o
- Verificar se todos os registros foram migrados
- Verificar logs de erro

Status: OK

Cen√°rio 6.2: Migra√ß√£o de M√∫ltiplas Tabelas
Situa√ß√£o: Migrar 110 collections de uma vez
Objetivo: Testar execu√ß√£o em paralelo
Teste:
- Selecionar todas as 110 collections
- Executar migra√ß√£o com rule preserts 
- Verificar relat√≥rio de cada collection
- Identificar gargalos de performance

Status: OK

7. Cen√°rios de Tratamento de Erros
Cen√°rio 7.1: Conflito de Primary Key
Situa√ß√£o: Registros com mesmo ID existem em DEV e HML
Objetivo: Testar regra "Insert Ignore"
Teste:
- Criar usu√°rio com ID=1 em DEV
- Criar usu√°rio com ID=1 em HML (dados diferentes)
- Executar migra√ß√£o com "Insert Ignore"
- Verificar se HML manteve seu registro original
- Verificar log de conflitos

Status:

Cen√°rio 7.2: Viola√ß√£o de Constraint
Situa√ß√£o: Campo NOT NULL sem valor
Objetivo: Testar rollback autom√°tico
Teste:
- Criar registro em DEV com campo obrigat√≥rio NULL
- Tentar migrar para HML
- Verificar se migra√ß√£o falhou
- Verificar se rollback foi executado
- Verificar se HML n√£o foi corrompido

8. Cen√°rios de Dados Sens√≠veis
Cen√°rio 8.1: Anonimiza√ß√£o de Dados
Situa√ß√£o: Migrar estrutura e dados, mas anonimizar emails
Objetivo: Proteger dados sens√≠veis em HML
Teste:
- Migrar users com emails reais em DEV
- Aplicar regra customizada para anonimizar
- Verificar se emails foram alterados para "user{id}@test.com"
- Verificar se outros dados foram preservados

Cen√°rio 8.2: Exclus√£o de Campos Sens√≠veis
Situa√ß√£o: N√£o migrar campo "password_hash"
Objetivo: Migra√ß√£o parcial de campos
Teste:
- Configurar migra√ß√£o para excluir campo "password_hash"
- Executar migra√ß√£o
- Verificar se campo n√£o foi copiado

9. Cen√°rios de Rollback
Cen√°rio 9.1: Rollback Total
Situa√ß√£o: Migra√ß√£o executada com erro
Objetivo: Reverter todas as altera√ß√µes
Teste:
- Fazer backup do estado atual de HML
- Executar migra√ß√£o que falha no meio
- Executar rollback
- Verificar se HML voltou ao estado original

Cen√°rio 9.2: Rollback Parcial
Situa√ß√£o: 3 de 5 collections migraram com sucesso
Objetivo: Reverter apenas as que falharam
Teste:
- Executar migra√ß√£o de 5 collections
- Simular erro na 4¬™ collection
- Executar rollback seletivo
- Verificar estado de cada collection

10. Cen√°rios Complexos End-to-End
Cen√°rio 10.1: Deploy Completo de Feature
Description: "Deploy da feature de gest√£o de contratos - Sprint 45"

Situa√ß√£o: Nova feature desenvolvida em DEV com m√∫ltiplas tabelas

Teste Completo:
1. Migrar estruturas (Schema Only):
   - contracts
   - contract_items
   - contract_attachments
   - contract_history
   
2. Migrar dados mestres (Overwrite):
   - contract_types
   - contract_status
   
3. Migrar dados de teste (Insert Ignore):
   - 10 contratos de exemplo
   - 50 itens relacionados
   
4. Verifica√ß√µes:
   - Todas as tabelas criadas
   - Relacionamentos funcionando
   - Dados de teste dispon√≠veis
   - Nenhum erro nos logs

Cen√°rio 10.2: Sincroniza√ß√£o Incremental
Description: "Sincroniza√ß√£o semanal de dados mestres - Semana 12/2025"

Situa√ß√£o: Atualiza√ß√£o semanal de dados mestres

Teste Completo:
1. Identificar mudan√ßas em DEV desde √∫ltima migra√ß√£o
2. Migrar apenas registros novos/alterados com Upsert:
   - products (150 novos, 50 atualizados)
   - categories (5 novas)
   - suppliers (20 novos)
   
3. Verifica√ß√µes:
   - Registros novos adicionados
   - Registros existentes atualizados
   - Nenhum registro deletado por engano
   - Integridade mantida

üìã Checklist de Testes Recomendado
markdown### Antes da Migra√ß√£o
- [ ] Backup de HML realizado
- [ ] Conex√µes testadas (DEV e HML)
- [ ] Descri√ß√£o da migra√ß√£o documentada
- [ ] Regras de migra√ß√£o definidas por collection

### Durante a Migra√ß√£o
- [ ] Logs sendo gerados corretamente
- [ ] Progress bar funcionando
- [ ] Sem erros de conex√£o
- [ ] Performance aceit√°vel

### Ap√≥s a Migra√ß√£o
- [ ] Relat√≥rio gerado com sucesso
- [ ] Contagem de registros conferida
- [ ] Relacionamentos validados
- [ ] Queries de teste executadas
- [ ] Performance da aplica√ß√£o normal
- [ ] Logs sem erros cr√≠ticos
